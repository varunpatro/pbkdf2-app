function PBKDF2(r,t,n,i){var o,a,e=rstr2binb(r),s=t,h=n,b=0,c=i,f=null,_=Math.ceil(c/20),l=1,u=new Array(16),d=new Array(16),g=new Array(0,0,0,0,0),v="",C=this;16<e.length&&(e=binb_sha1(e,r.length*chrsz));for(var m=0;m<16;++m)u[m]=909522486^e[m],d[m]=1549556828^e[m];this.deriveKey=function(r,t){a=r,o=t,setTimeout(function(){C.do_PBKDF2_iterations()},0)},this.do_PBKDF2_iterations=function(){var r=10;h-b<10&&(r=h-b);for(var t=0;t<r;++t){if(0==b){var n=s+String.fromCharCode(l>>24&15)+String.fromCharCode(l>>16&15)+String.fromCharCode(l>>8&15)+String.fromCharCode(15&l);f=binb_sha1(u.concat(rstr2binb(n)),512+8*n.length),f=binb_sha1(d.concat(f),672)}else f=binb_sha1(u.concat(f),512+32*f.length),f=binb_sha1(d.concat(f),672);for(var i=0;i<f.length;++i)g[i]^=f[i];b++}if(a((l-1+b/h)/_*100),b<h)setTimeout(function(){C.do_PBKDF2_iterations()},0);else if(l<_)v+=rstr2hex(binb2rstr(g)),l++,g=new Array(0,0,0,0,0),b=0,setTimeout(function(){C.do_PBKDF2_iterations()},0);else{var e=rstr2hex(binb2rstr(g));v+=e.substr(0,2*(c-20*(_-1))),o(v)}}}